<h1>Projects</h1>
<i class="fa fa-circle-o-notch fa-spin" style="font-size: 34px;" *ngIf="isProjectLoading"></i>
<div class="row">
  <div class="col-9 mx-auto">
    <div class="form-group form-row">
      <div class="col-2">
        <button class="btn btn-primary" data-toggle="modal" data-target = "#newModal">Create Project</button>
      </div>
      <label for="drpSearchBy" class="col-form-label col-2">Search To</label>
      <div class="col-3">
        <select class="form-control" id="drpSearchBy" name="searchBy" [(ngModel)]="searchBy">
          <option value="projectID">Project ID</option>
          <option value="projectName">Project Name</option>
          <option value="dateOfStart">Date of Start</option>
          <option value="teamSize">Team Size</option>
        </select>
      </div>
      <label for="drpSearchBy" class="col-form-label col-2">Search By</label>
      <div class="col-3">
        <div class="input-group">
          <input type="text" class="form-control" id="txtSearchText" name="searchText" [(ngModel)]="searchText">
          <div class="input-group-append" (click)="onSearchClick()">
            <span class="input-group-text"><i class="fa fa-search"></i></span>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-8 mx-auto">
    <div class="table">
      <thead>
      <th>Project ID</th>
      <th>Project Name</th>
      <th>Date of Start</th>
      <th>Team Size</th>
      <th>Project Status</th>
      <th>Project Name</th>
      <th>Action</th>
      </thead>
      <tbody>
      <tr *ngFor="let project of projects; let i = index" [ngClass]="{'text-muted': !project.active}">
        <td>{{project.projectId}}</td>
        <td>{{project.projectName}}</td>
        <td>{{project.dateOfStart}}</td>
        <td>{{project.teamSize}}</td>
        <td>{{project.active}}</td>
        <td>{{project.projectName}}</td>
        <td>
          <button class="btn btn-info mx-1" (click)="onEditClick($event, i)" data-toggle="modal" data-target = "#editModal">Edit</button>
          <button class="btn btn-warning" (click)="onDeleteClick($event, i)" data-toggle="modal" data-target = "#deleteModal">Delete</button>
        </td>
      </tr>
      </tbody>
    </div>
  </div>
</div>
<!-- Add New Projects -->
<form #newForm = "ngForm" novalidate="novalidate">
  <div class="modal" role="dialog" id="newModal">
    <div class="modal-dialog">
      <div class = "modal-content">
        <div class="modal-header bg-primary text-white">
          <div class="modal-title">New Projects</div>
          <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
        </div>
        <div class="modal-body">

          <div class="form-group row">
            <label for="newProjectId" class="col-sm-4 col-form-label">Project ID</label>
            <div class="col-sm-8">
              <input type="text" id="newProjectId" class="form-control"
                     placeholder="Project ID" name="projectID" [(ngModel)] = "newProject.projectId"
                      required="required" pattern="^[0-9]*$"  appProjectIdUniqueValidators #newProjectID = "ngModel"
                      [ngClass]="{'is-invalid':newProjectID.invalid && (newProjectID.dirty||newProjectID.touched || newForm.submitted)
                                  , 'is-valid': newProjectID.valid && (newProjectID.dirty||newProjectID.touched|| newForm.submitted)}">
              <span class="text-danger" *ngIf="newProjectID.invalid && (newProjectID.dirty||newProjectID.touched || newForm.submitted)&&
                                                newProjectID.errors?.required">Project ID cannot be blank.</span>
              <span class="text-danger" *ngIf="newProjectID.invalid && (newProjectID.dirty||newProjectID.touched || newForm.submitted)&&
                                                newProjectID.errors?.pattern">Project ID must be number.</span>
              <span class="text-danger" *ngIf="newProjectID.invalid && (newProjectID.dirty||newProjectID.touched || newForm.submitted)&&
                                                newProjectID.errors?.uniqueProjectId">Project Id is duplicate</span>
            </div>
          </div>

          <div class="form-group row">
            <label for="newProjectName" class="col-sm-4 col-form-label">Project Name</label>
            <div class="col-sm-8">
              <input type="text" id="newProjectName" class="form-control" placeholder="Project Name" minlength="3" maxlength="30" name="projectName" [(ngModel)]="newProject.projectName"
                     required="required" pattern="^[A-Za-z0-9 /-]*$" #newProjectName = "ngModel"
                     [ngClass]="{'is-invalid':newProjectName.invalid && (newProjectName.dirty||newProjectName.touched || newForm.submitted)
                                  , 'is-valid': newProjectName.valid && (newProjectName.dirty||newProjectName.touched|| newForm.submitted)}">
              <span class="text-danger" *ngIf="newProjectName.invalid && (newProjectName.dirty||newProjectName.touched || newForm.submitted)&&
                                                newProjectName.errors?.required">Project Name cannot be blank.</span>
              <span class="text-danger" *ngIf="newProjectName.invalid && (newProjectName.dirty||newProjectName.touched || newForm.submitted)&&
                                                newProjectName.errors?.pattern">Project Name contains alphabate digit and char.</span>
              <span class="text-danger" *ngIf="newProjectName.invalid && (newProjectName.dirty||newProjectName.touched || newForm.submitted)&&
                                                newProjectName.errors?.minlength">Project Name must be geater than 3.</span>
              <span class="text-danger" *ngIf="newProjectName.invalid && (newProjectName.dirty||newProjectName.touched || newForm.submitted)&&
                                                newProjectName.errors?.maxlength">Project Name must be less than 30</span>
            </div>
          </div>

          <div class="form-group row">
            <label for="newDateOfStart" class="col-sm-4 col-form-label">Date Of Start</label>
            <div class="col-sm-8">
              <input type="date" id="newDateOfStart" class="form-control" placeholder="Date of Start" required="required" name="dateOfStart" [(ngModel)]="newProject.dateOfStart"
                     #newProjectDate = "ngModel" [ngClass]="{'is-invalid':newProjectDate.invalid && (newProjectDate.dirty||newProjectDate.touched || newForm.submitted)
                                  , 'is-valid': newProjectDate.valid && (newProjectDate.dirty||newProjectDate.touched|| newForm.submitted)}">
              <span class="text-danger" *ngIf="newProjectDate.invalid && (newProjectDate.dirty||newProjectDate.touched || newForm.submitted)&&
                                                newProjectDate.errors?.required">Project date cannot be empty</span>
            </div>
          </div>

          <div class="form-group row">
            <label for="newTeamSize" class="col-sm-4 col-form-label">Team Size</label>
            <div class="col-sm-8">
              <input type="text" id="newTeamSize" class="form-control" appTeamsizevalidator = "5" placeholder="Team Size" name="teamSizes" [(ngModel)]="newProject.teamSize" pattern="[0-9]*$"
                      #newTeamSize = "ngModel" [ngClass]="{'is-invalid':newTeamSize.invalid && (newTeamSize.dirty||newProjectID.touched || newForm.submitted)
                                  , 'is-valid': newTeamSize.valid && (newTeamSize.dirty||newTeamSize.touched|| newForm.submitted)}">
              <span class="text-danger" *ngIf="newTeamSize.invalid && (newTeamSize.dirty||newTeamSize.touched || newForm.submitted)&&
                                                newTeamSize.errors?.pattern">Team size must be number</span>
              <span class="text-danger" *ngIf="newTeamSize.invalid && (newTeamSize.dirty||newTeamSize.touched || newForm.submitted)&&
                                                newTeamSize.errors?.divisible">Team size must be divisible by 5.</span>
            </div>
          </div>

          <div class="form-group row">
            <label for="Active" class="col-sm-4 col-form-label">Active</label>
            <div class="col-sm-8">
              <div class="form-check">
                <input type="checkbox" id="Active" class="form-check-input" value="true" [(ngModel)]="newProject.active">
              </div>
            </div>
          </div>

          <div class="form-group row">
            <label for="statusInForces" class="col-sm-4 col-form-label">Status</label>
            <div class="col-sm-8">
              <div class="form-check form-check-inline">
                <input type="radio" id="statusInForces" class="form-check-input"  name="statusForce" [(ngModel)]="newProject.status">
                <label for="statusInForces" class="form-check-label">In Force</label>
              </div>
              <div class="form-check form-check-inline">
                <input type="radio" id="statusInSupport" class="form-check-input"  name="statusSupport" [(ngModel)]="newProject.status">
                <label for="statusInSupport" class="form-check-label">Support</label>
              </div>

            </div>
          </div>

          <div class="form-group row">
            <label for="clientLoaction" class="col-sm-4 col-form-label">Client Location</label>
            <div class="col-sm-8">
              <select id="clientLoaction" class="form-control" name="clientLocation"
                      [(ngModel)]="newProject.clientLocationId" required="required"
                      #newClientLocation = "ngModel" [ngClass]="{'is-invalid':newClientLocation.invalid && (newClientLocation.dirty||newProjectID.touched || newForm.submitted)
                                  , 'is-valid': newClientLocation.valid && (newClientLocation.dirty||newClientLocation.touched|| newForm.submitted)}">
                <option value="null">Please Select</option>
                <option *ngFor="let clientLocation of clientLocation" [value]="clientLocation.clientLocationId">
                  {{clientLocation.clientLocationName}}
                </option>
              </select>
              <span class="text-danger" *ngIf="newClientLocation.invalid && (newClientLocation.dirty||newClientLocation.touched || newForm.submitted)&&
                                                newClientLocation.errors?.required">Select at least one value</span>
            </div>
          </div>

        </div>
        <div class="modal-footer">
          <button class="btn btn-warning" data-dismiss="modal" id="newFormCancel">Cancel</button>
          <button class="btn btn-success" (click)="onSaveClick()">Save</button>
        </div>
      </div>
    </div>
  </div>
</form>
<!-- Edit Projects -->
<form>
  <div class="modal" role="dialog" id="editModal" appAppClientLocationValidator>
    <div class="modal-dialog">
      <div class = "modal-content">
        <div class="modal-header">
          <div class="modal-title">Edit Projects</div>
          <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
        </div>
        <div class="modal-body">

          <div class="form-group row">
            <label for="editProjectId" class="col-sm-4 col-form-label">Project ID</label>
            <div class="col-sm-8">
              <input type="text" id="editProjectId" class="form-control-plaintext"
                     placeholder="Project ID" name="projectID" [(ngModel)] = "editProject.projectId" disabled="disabled">
            </div>
          </div>

          <div class="form-group row">
            <label for="editProjectName" class="col-sm-4 col-form-label">Project Name</label>
            <div class="col-sm-8">
              <input type="text" id="editProjectName" class="form-control" placeholder="Project Name" name="projectName" [(ngModel)]="editProject.projectName"
                     required="required" pattern="^[A-Za-z0-9 /-]*$" #editProjectName = "ngModel"
                     [ngClass]="{'is-invalid':editProjectName.invalid && (editProjectName.dirty||editProjectName.touched || newForm.submitted)
                                  , 'is-valid': editProjectName.valid && (editProjectName.dirty||editProjectName.touched|| newForm.submitted)}">
              <span class="text-danger" *ngIf="editProjectName.invalid && (editProjectName.dirty||editProjectName.touched || newForm.submitted)&&
                                                editProjectName.errors?.required">Project Name cannot be blank.</span>
              <span class="text-danger" *ngIf="editProjectName.invalid && (editProjectName.dirty||editProjectName.touched || newForm.submitted)&&
                                                editProjectName.errors?.pattern">Project Name contains alphabate digit and char.</span>
              <span class="text-danger" *ngIf="editProjectName.invalid && (editProjectName.dirty||editProjectName.touched || newForm.submitted)&&
                                                editProjectName.errors?.minlength">Project Name must be geater than 3.</span>
              <span class="text-danger" *ngIf="editProjectName.invalid && (editProjectName.dirty||editProjectName.touched || newForm.submitted)&&
                                                editProjectName.errors?.maxlength">Project Name must be less than 30</span>
              <span class="text-danger" *ngIf="editForm.invalid && (editForm.dirty||editForm.touched || editForm.submitted)&&
                                                editForm.errors?.clientLocationStatus">PForm name is Nepal. form leve eror.</span>>
            </div>
          </div>

          <div class="form-group row">
            <label for="editDateOfStart" class="col-sm-4 col-form-label">Date Of Start</label>
            <div class="col-sm-8">
              <input type="date" id="editDateOfStart" class="form-control" placeholder="Date of Start" name="editDateOfStart" [(ngModel)]="editProject.dateOfStart"
                     #editDateOfStart = "ngModel" [ngClass]="{'is-invalid':editDateOfStart.invalid && (editDateOfStart.dirty||editDateOfStart.touched || newForm.submitted)
                                  , 'is-valid': editDateOfStart.valid && (editDateOfStart.dirty||editDateOfStart.touched|| newForm.submitted)}">
              <span class="text-danger" *ngIf="editDateOfStart.invalid && (editDateOfStart.dirty||editDateOfStart.touched || newForm.submitted)&&
                                                editDateOfStart.errors?.required">Project date cannot be empty</span>>
            </div>
          </div>

          <div class="form-group row">
            <label for="editTeamSize" class="col-sm-4 col-form-label">Team Size</label>
            <div class="col-sm-8">
              <input type="number" id="editTeamSize" class="form-control" placeholder="Team Size" name="editTeamSize" [(ngModel)]="editProject.teamSize"
                     pattern="[0-9]*$"
                     appTeamsizevalidator = "5" #editTeamSize = "ngModel" [ngClass]="{'is-invalid':editTeamSize.invalid && (editTeamSize.dirty||newProjectID.touched || newForm.submitted)
                                  , 'is-valid': editTeamSize.valid && (editTeamSize.dirty||editTeamSize.touched|| newForm.submitted)}">
              <span class="text-danger" *ngIf="editTeamSize.invalid && (editTeamSize.dirty||editTeamSize.touched || newForm.submitted)&&
                                                editTeamSize.errors?.pattern">Team size must be number</span>
              <span class="text-danger" *ngIf="editTeamSize.invalid && (editTeamSize.dirty||editTeamSize.touched || newForm.submitted)&&
                                                editTeamSize.errors?.divisible">Team size must be divisible by 5</span>>
            </div>
          </div>
          <div class="form-group row">
            <label for="editActive" class="col-sm-4 col-form-label">Active</label>
            <div class="col-sm-8">
              <div class="form-check">
                <input type="checkbox" id="editActive" class="form-check-input" value="true" [(ngModel)]="editProject.active">
              </div>
            </div>
          </div>

          <div class="form-group row">
            <label for="editstatusInForce" class="col-sm-4 col-form-label">Status</label>
            <div class="col-sm-8">
              <div class="form-check form-check-inline">
                <input type="radio" id="editstatusInForce" class="form-check-input"  name="status" [(ngModel)]="editProject.status">
                <label for="editstatusInForce" class="form-check-label">In Force</label>
              </div>
              <div class="form-check form-check-inline">
                <input type="radio" id="editstatusInSupport" class="form-check-input"  name="status" [(ngModel)]="newProject.status">
                <label for="editstatusInSupport" class="form-check-label">Support</label>
              </div>

            </div>
          </div>

          <div class="form-group row">
            <label for="editclientLoaction" class="col-sm-4 col-form-label">Client Location</label>
            <div class="col-sm-8">
              <select id="editclientLoaction" class="form-control" name="clientLocation"
                      [(ngModel)]="editProject.clientLocationId" required="required"
                      #editClientLocation = "ngModel" [ngClass]="{'is-invalid':editClientLocation.invalid && (editClientLocation.dirty||newProjectID.touched || newForm.submitted)
                                  , 'is-valid': editClientLocation.valid && (editClientLocation.dirty||editClientLocation.touched|| newForm.submitted)}">>
                <option value="null">Please Select</option>
                <option *ngFor="let client of clientLocation" [value]="client.clientLocationId">
                  {{client.clientLocationName}}
                </option>
              </select>
              <span class="text-danger" *ngIf="editClientLocation.invalid && (editClientLocation.dirty||editClientLocation.touched || newForm.submitted)&&
                                                editClientLocation.errors?.required">Select at least one value</span>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-warning" id="editFormCancel" data-dismiss="modal">Cancel</button>
          <button class="btn btn-success"  (click)="onUpdateClick()">Update</button>
        </div>
      </div>
    </div>
  </div>
</form>

<!-- Delete Projects -->
<form>
  <div class="modal" role="dialog" id="deleteModal">
    <div class="modal-dialog">
      <div class = "modal-content">
        <div class="modal-header">
          <div class="modal-title">Delete Projects</div>
          <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
        </div>
        <div class="modal-body">

          <div class="form-group row">
            <label for="deleteProjectId" class="col-sm-4 col-form-label">Project ID</label>
            <div class="col-sm-8">
              <input type="text" id="deleteProjectId" class="form-control-plaintext"
                     placeholder="Project ID" name="projectID" [(ngModel)] = "deleteProject.projectId" disabled="disabled">
            </div>
          </div>

          <div class="form-group row">
            <label for="deleteProjectName" class="col-sm-4 col-form-label">Project Name</label>
            <div class="col-sm-8">
              <input type="text" id="deleteProjectName" class="form-control-plaintext"
                     placeholder="Project Name" name="projectName" [(ngModel)]="deleteProject.projectName" disabled = "disabled">
            </div>
          </div>

          <div class="alert alert-warning text-warning" role="alert">
            Are you sure you want to delete?
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-warning" data-dismiss="modal">Cancel</button>
          <button class="btn btn-success" data-dismiss="modal" (click)="onDeleteConfirmClick()">Delete</button>
        </div>
      </div>
    </div>
  </div>
</form>


